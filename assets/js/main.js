import './config';
import * as Sentry from '@sentry/browser';
import { Vue as SentryVue } from '@sentry/integrations';
import Vue from 'vue';
import { featureIsEnabled } from './helpers/features';

Sentry.init({
    dsn: 'https://53aa5923a25c43cd9a645d9207ae5b6c@sentry.io/226416',
    environment: window.AppConfig.environment,
    ignoreErrors: [
        'fb_xd_fragment',
        /ReferenceError:.*/,
        // Error generated by a autofill function of Chrome for iOS
        // https://github.com/getsentry/sentry/issues/5267
        /Blocked a frame with origin/
    ],
    integrations(integrations) {
        // eslint-disable-next-line
        if (process.env.NODE_ENV === 'production') {
            integrations.push(new SentryVue({ Vue }));
        }
        return integrations;
    }
});

import(/* webpackChunkName: "common" */ './common/index').then(common => {
    common.init();
});

import(/* webpackChunkName: "vue-apps" */ './vue-apps/index').then(vueApps => {
    vueApps.init();
});

if (featureIsEnabled('analytics')) {
    import(/* webpackChunkName: "analytics" */ './analytics').then(
        analytics => {
            analytics.init();
        }
    );
}
