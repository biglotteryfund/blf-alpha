{% from "components/forms-new.njk" import formHeader %}

{% extends "layouts/main.njk" %}

{% block title %}{{ stepConfig.title }} | {{ form.title }} | {% endblock %}

{% set bodyClass = 'has-static-header' %}

{% block content %}
    {% set pageAccent = 'pink' %}
    <main role="main" id="content">
        <form action="" method="POST"
            class="js-application-form js-application-form-review
            content-box u-inner-wide-only accent--{{ pageAccent }} a--border-top">
            <div class="u-constrained-content">

                {{ formHeader(form.title, stepProgress) }}

                <section class="s-prose accent-content--{{ pageAccent }} u-constrained-wide">
                    <h2>{{ stepConfig.title }}</h2>

                    {% for step in summary %}
                        <h3>
                            {{ step.name }}
                            [<a href="{{ baseUrl }}/{{ loop.index }}/edit"
                                class="js-application-form-review-link"
                                aria-label="Edit {{ step.name }}">
                                Edit
                            </a>]
                        </h3>
                        {% for fieldset in step.fieldsets %}
                        <dl class="review-list {% if fieldset.fields.length === 1 %}review-list--stacked{% endif %}">
                            {% for field in fieldset.fields %}
                                {% if field.value %}
                                    <dt>{{ field.label }}</dt>
                                    <dd data-hj-suppress>
                                        {% if field.type === 'textarea' %}
                                            {{ field.value | striptags(true) | escape | nl2br }}
                                        {% elseif field.type === 'checkbox' %}
                                            {{ field.value | joinIfArray(', ') }}
                                        {% else %}
                                            {{ field.value }}
                                        {% endif %}
                                    </dd>
                                {% endif %}
                            {% endfor %}
                        </dl>
                        {% endfor %}
                    {% endfor %}
                </section>
            </div>

            {% if csrfToken %}
                <input type="hidden" name="_csrf" value="{{ csrfToken }}">
            {% endif %}

            <input class="btn btn--next" type="submit" value="{{ stepConfig.proceedLabel }}" />
        </form>
    </main>
{% endblock %}
