{% import "../../components/hero.njk" as hero %}
{% import "../../components/headers.njk" as headers %}
{% from "../../components/forms.njk" import input, radios with context %}

{% extends "../../layouts/main.njk" %}

{% set bodyClass = "has-overlay" %}
{% set globalFootnote = "*The grant amount shown was awarded within the last 12 months" %}

{% block title %}{{ title }} | {% endblock %}

{% macro caseStudy() %}
    <ul class="unstyled grid vox-pop">
        <li class="grid__item vox-pop__image">
            <img src="{{ 'images/funding/tell-the-world.jpg' | getCachebustedPath }}" alt="A case study" />
        </li>
        <li class="grid__item vox-pop__blurb">
            <blockquote class="pullquote">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam finibus urna laoreet condimentum pharetra. Orci varius natoque penatibus.</p>
                <p>Let magnis dis parturient montes, nascetur ridiculus</p>
                <cite class="t3 t3--b">Jane Bloggs</cite>
                <aside class="t6">Project name</aside>
            </blockquote>
        </li>
    </ul>
{% endmacro %}

{% block content %}

    {# {% set heroContent %}
        {{ headers.overlayText('h2', "The Big Lottery Fund is the largest funder of community activities in the UK. We distribute money raised by players of the <a href=\"https://www.national-lottery.co.uk\">National Lottery</a>", 'overlay-text--has-links t2') }}
    {% endset %} #}
    {% set heroContent %}
        <h2 class="o-hero-text">
            The Big Lottery Fund distributes <a href="#">over £600m</a> a year to communities
            across the UK, raised by players of the <a href="https://www.national-lottery.co.uk/">National Lottery</a>.
        </h2>

        <div class="padded">
            <a class="btn btn--small [ accent--white a--btn ]"
                href="{{ buildUrl('toplevel', 'under10k') }}">
                <span class="accent--pink a--text">
                    Learn how to apply for funding under £10,000
                </span>
            </a>

            <a class="btn btn--small [ accent--white a--btn ]"
                href="{{ buildUrl('toplevel', 'over10k') }}">
                <span class="accent--blue a--text">
                    Learn how to apply for funding over £10,000
                </span>
            </a>
        </div>
    {% endset %}

    {{
        hero.superHero(
            name = 'home-super',
            content = heroContent,
            caption = 'Cloughmills Community Action, Grant £4,975*'
        )
    }}

    <article role="main">
        <div class="inner">
            <h3 class="align--center">Here's how you can make a difference in your community...</h3>

            {# funding apply links #}
            <ul class="unstyled grid grid--2-up grid--padded grid--equal grid--wide-only">

                {# under 10k #}
                <li class="grid__item">
                    <div class="grid__item__inner--flex accent--pink a--border-top--large">
                        {% set miniHeroContent %}
                            {{ headers.overlayText(
                                tag = 'h4',
                                text = "Every year thousands of people apply to National Lottery Awards for All for grants between £500 and £10,000",
                                additionalClasses = 'is-opaque',
                                link = buildUrl('toplevel', 'under10k'),
                                showArrow = false
                            )}}
                        {% endset %}
                        {{ hero.miniature(
                            imagePath = 'images/home/under10k.jpg',
                            imageCaption = 'Children gardening together',
                            link = buildUrl('toplevel', 'under10k'),
                            content = miniHeroContent
                        )}}
                    </div>
                    <div class="padded bordered">
                        <a class="btn accent--pink a--btn btn--block btn--small" href="{{ buildUrl('toplevel', 'under10k') }}">
                            <span class="light">Apply for funding</span> <strong>under £10k</strong>
                        </a>
                    </div>
                </li>

                {# over 10k #}
                <li class="grid__item">
                    <div class="grid__item__inner--flex accent--turquoise a--border-top--large">
                        {% set miniHeroContent %}
                            {{ headers.overlayText(
                                tag = 'h4',
                                text = "Many people apply for larger sums of money (over £10,000) over longer periods of time",
                                additionalClasses = 'is-opaque',
                                link = buildUrl('toplevel', 'over10k'),
                                showArrow = false
                            )}}
                        {% endset %}
                        {{ hero.miniature(
                            imagePath = 'images/home/over10k.jpg',
                            imageCaption = 'Two women laughing while sharing a coffee',
                            link = buildUrl('toplevel', 'over10k'),
                            content = miniHeroContent
                        )}}
                    </div>
                    <div class="padded bordered">
                        <a class="btn accent--turquoise a--btn btn--block btn--small" href="{{ buildUrl('toplevel', 'over10k') }}">
                            <span class="light">Apply for funding</span> <strong>over £10k</strong>
                        </a>
                    </div>
                </li>
            </ul>

            {# news posts #}
            {% if news.length %}
            <div class="accent--blue a--border-top">
                <div class="padded">
                    <h3 class="t3 t3--a">
                        Latest News
                    </h3>
                    <ul class="unstyled grid grid--3-up grid--padded--large grid--equal grid--wide-only">
                        {% for n in news %}
                        <li class="grid__item">
                            <h4 class="t3">
                                <a class="u-unstyled-link" href="{{ n['link' | localeify(locale)] }}">
                                    {{ n['title' | localeify(locale)] | safe}}
                                </a>
                            </h4>
                            <p>
                                {{ n['text' | localeify(locale)] | safe }}
                                <a href="{{ n['link' | localeify(locale)] }}"
                                    class="accent--pink a--text heavier">Read more&hellip;</a>
                            </p>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            {% endif %}

            {# funding finder #}
            <div class="central-gap">
                <a href="#" class="btn btn--block accent--blue a--btn spaced">Find out what we funded</a>
            </div>
        </div>

        <div class="inner--wide-only">

            {# case studies #}
            <div class="accent--blue a--border-top vox-pop-container swiper-container" data-per-page="1">

                <div class="vox-pop__buttons">
                    <button class="btn--carousel btn--carousel--round btn--carousel--prev js-carousel-prev">
                        {% include "../../includes/svg/arrow-left.svg" %}
                        <span class="visually-hidden">Previous item</span>
                    </button>

                    <button class="btn--carousel btn--carousel--round btn--carousel--next js-carousel-next">
                        {% include "../../includes/svg/arrow-right.svg" %}
                        <span class="visually-hidden">Next item</span>
                    </button>
                </div>

                <ul class="swiper-wrapper unstyled">
                    <li class="swiper-slide">{{ caseStudy() }}</li>
                    <li class="swiper-slide">{{ caseStudy() }}</li>
                    <li class="swiper-slide">{{ caseStudy() }}</li>
                    <li class="swiper-slide">{{ caseStudy() }}</li>
                    <li class="swiper-slide">{{ caseStudy() }}</li>
                </ul>

            </div>

            {# tweets #}
            <ul class="unstyled grid grid--wide-only grid--equal">
                <li class="grid__item grid__item--large accent--blue a--border-top padded">
                    <a class="twitter-timeline" href="https://twitter.com/BigLotteryFund" data-tweet-limit="3" data-chrome="noheader">Tweets by BigLotteryFund</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
                </li>
                <li class="grid__item accent--pink a--border-top">
                    <form class="form-ebulletin padded spaced" id="{{ anchors.ebulletin }}" method="post" action="/ebulletin">
                        <h3 class="t3 t3--a accent--pink a--text">e-bulletin sign up</h3>

                        {% if request.flash and request.flash('ebulletinStatus') %}
                            {% if request.flash('ebulletinStatus') === 'success' %}
                                <h5 class="t4">Thank you for subscribing to receive updates and news from the Big Lottery Fund</h5>
                                <p class="t6">Your personal data is important to us and we will not share it with third parties. We are sure you will enjoy hearing from us, but you can <a href="http://bigmail.org.uk/t/3V8D-8ASA-B715KZGHE3/uns.aspx">unsubscribe at any time</a> if you wish.</p>
                            {% else %}
                                <h5 class="t4">There was an error signing you up to the e-bulletin.</h5>
                                <p class="t6">It looks like we're experiencing an error with our e-bulletin tool. Please try again later.</p>
                            {% endif %}
                        {% else %}
                            <input type="hidden" name="_csrf" value="{{ csrfToken }}">
                            <input type="hidden" name="addressbookid" value="589755">
                            <input type="hidden" name="userid" value="180445">
                            <input type="hidden" name="ReturnURL" value="{{ appData.config.get('ebulletinDestination') }}">

                            <p class="intro">Sign up for our latest news relating to your country:</p>

                            <div class="form-ebulletin--grid" role="group" aria-labelledby="aria-form-loc">
                                <span class="visually-hidden" id="aria-form-loc">Location</span>
                                {{ radios('location', [
                                    ['England', 'en', 'cd_ENGLAND_MAIL'],
                                    ['Wales', 'cy', 'cd_WALES_MAIL'],
                                    ['Scotland', 'sc', 'cd_SCOTLAND_MAIL'],
                                    ['Northern Ireland', 'ni', 'cd_NI_MAIL']
                                ]) }}
                            </div>

                            <div class="grid grid--padded clear-both">
                                {{ input('cd_FIRSTNAME', 'First name', 'text', required = true, extraClasses = 'grid__item') }}
                                {{ input('cd_LASTNAME', 'Last name', 'text', required = true, extraClasses = 'grid__item') }}
                            </div>
                            {{ input('cd_ORGANISATION', 'Organisation', 'text', required = false, extraClasses = 'no-gap') }}
                            {{ input('Email', 'Email', 'email', required = true) }}

                            <input type="submit" value="Subscribe" class="btn btn--small accent--pink a--btn form-ebulletin__btn" />
                        {% endif %}
                    </form>

                    {# social buttons #}
                    <div class="gutter-mob-only">
                        <a href="{{ appData.config.get('social.instagram') }}" class="btn btn--small btn--outline accent--blue btn--block spaced--s">
                            <span class="btn__icon">{% include "../../includes/svg/instagram.svg" %}</span>Follow us on Instagram
                        </a>
                        <a href="{{ appData.config.get('social.facebook') }}" class="btn btn--small btn--outline accent--blue btn--block spaced--s">
                            <span class="btn__icon">{% include "../../includes/svg/facebook.svg" %}</span>Follow us on Facebook
                        </a>
                        <a href="{{ appData.config.get('social.twitter') }}" class="btn btn--small btn--outline accent--blue btn--block">
                            <span class="btn__icon">{% include "../../includes/svg/twitter.svg" %}</span>Follow us on Twitter
                        </a>
                    </div>

                </li>
            </ul>

        </div>
    </article>

{% endblock %}
