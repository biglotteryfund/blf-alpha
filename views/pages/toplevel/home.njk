{% from "components/promo-card/macro.njk" import promoCard %}
{% from "components/ebulletin.njk" import ebulletinForm with context %}
{% from "components/hero.njk" import superHero with context %}
{% from "components/news.njk" import articleTeaser with context %}
{% from "components/social.njk" import socialLinks with context %}

{% extends "layouts/main.njk" %}
{% set pageAccent = "blue" %}

{% block content %}
    <main role="main">
        {% call superHero(
            title = copy.hero.intro,
            imageDefault = heroImage.default,
            imageCandidates = heroImage.candidates
        ) %}
            <div class="o-button-group">
                <a class="btn btn--reversed btn--medium"
                    href="{{ localify('/funding/under10k') }}"
                    id="qa-button-under10k">
                    <span class="accent--pink a--text">
                        <span class="u-wide-only">{{ copy.hero.under10k.long }}</span>
                        <span class="u-not-wide">{{ copy.hero.under10k.short }}</span>
                    </span>
                </a>
                <a class="btn btn--reversed btn--medium"
                    href="{{ localify('/funding/over10k') }}"
                    id="qa-button-over10k">
                    <span class="accent--blue a--text">
                        <span class="u-wide-only">{{ copy.hero.over10k.long }}</span>
                        <span class="u-not-wide">{{ copy.hero.over10k.short }}</span>
                    </span>
                </a>
            </div>
        {% endcall %}

        {# Case studies #}
        <section class="u-inner">
            <h2 class="t2 t--underline">
                {{ __('global.misc.projectExamples') }}
            </h2>
            <ul class="flex-grid flex-grid--3up">
                {% for caseStudy in copy.caseStudies %}
                    <li class="flex-grid__item">
                        {% call promoCard({
                            "title": caseStudy.quoteText,
                            "image": { "url": caseStudy.imageUrl | getImagePath, "alt": caseStudy.quoteName }
                        }) %}
                            <p class="u-no-margin"><strong>{{ caseStudy.quoteName }}</strong></p>
                            {% if caseStudy.quoteNameCaption %}
                                <p class="u-no-margin">{{ caseStudy.quoteNameCaption }}</p>
                            {% endif %}
                            {% if caseStudy.link %}<a href="{{ localify(caseStudy.link) }}"
                                aria-label="{{ __('global.misc.readMoreAbout', caseStudy.projectName) }}">{% endif %}
                                {{ caseStudy.projectName }}
                            {% if caseStudy.link %}</a>{% endif %}
                        {% endcall %}
                    </li>
                {% endfor %}
            </ul>

            <div class="u-padded u-align-center">
                <a href="{{ localify('/funding/past-grants') }}"
                    class="btn accent--{{ pageAccent }} a--btn u-margin-bottom">
                    {{ copy.browseFundedProjects }}
                </a>
            </div>
        </section>

        {# Latest News #}
        {% if news.length %}
        <section class="latest-news accent--{{ pageAccent }} a--border-top u-inner">
            <header class="latest-news__header">
                <h2 class="t1 t--underline a--text accent--blue">
                    <a class="u-link-minimal" href="{{ localify("/uk-wide/news-and-events") }}">
                        {{ __('global.misc.latestNews') }}
                    </a>
                </h2>
            </header>
            <div class="latest-news__content">
                <ul class="flex-grid flex-grid--3up">
                    {% for article in news %}
                        <li class="flex-grid__item">
                            {{ articleTeaser(article) }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <footer class="latest-news__footer">
                <a class="latest-news__more" href="{{ localify("/uk-wide/news-and-events") }}">
                    {{ __('global.misc.viewAllNews') }}
                </a>
            </footer>
        </section>
        {% endif %}

        {# Social Content #}
        <section class="social-content u-inner-wide-only u-margin-bottom">
            <div class="social-content__primary u-accent-border-top-blue">
                {# Twitter Feed #}
                <div class="u-padded">
                    {% set twitterAccount = __('global.brand.twitter')  %}
                    <a class="twitter-timeline" data-dnt="true" data-chrome="noheader" data-tweet-limit="3"
                        href="https://twitter.com/{{ twitterAccount }}?ref_src=twsrc%5Etfw"
                    >
                        Tweets by {{ twitterAccount }}
                    </a>
                    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                </div>
            </div>
            <div class="social-content__secondary u-accent-border-top-pink">
                {# Ebulletin #}
                <div class="content-box content-box--tinted">
                    {{ ebulletinForm() }}
                </div>

                {# Social links #}
                {{ socialLinks(copy.social) }}
            </div>
        </section>
    </main>
{% endblock %}
