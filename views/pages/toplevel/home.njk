{% import "../../components/hero.njk" as hero %}
{% import "../../components/headers.njk" as headers %}
{% from "../../components/forms.njk" import input, radios with context %}

{% extends "../../layouts/main.njk" %}

{% set bodyClass = "has-full-bleed-header" %}
{% set globalFootnote = "* " + __('global.footerLinks.grantFootnote') %}

{% block title %}{{ title }} | {{ copy.home }} | {% endblock %}

{% macro caseStudy(projectName, quoteName, quoteText, imageUrl, imageSmallUrl, link = false) %}

    <div class="case-study">
        {% if link %}<a href="{{ buildUrl(link) }}">{% endif %}
            <picture class="case-study__image">
                <source srcset="{{ imageUrl | getCachebustedPath }}" media="(min-width: 600px)">
                <source srcset="{{ imageSmallUrl | getCachebustedPath }}">
                <img src="{{ imageSmallUrl | getCachebustedPath }}" alt="{{ quoteName }} {{ projectName }}" />
            </picture>
        {% if link %}</a>{% endif %}
        <div class="case-study__content">
                <blockquote class="pullquote">
                    <div class="pullquote__text">
                        <p>{{ quoteText }}</p>
                    </div>
                    <div class="pullquote__meta">
                        <cite class="t3 t3--b">{{ quoteName }}</cite>
                        {% if link %}<a href="{{ buildUrl(link) }}">{% endif %}
                            <aside class="pullquote__aside t6 u-weight-normal">{{ projectName }}</aside>
                        {% if link %}</a>{% endif %}
                    </div>
                </blockquote>
        </div>
    </div>
{% endmacro %}

{% block content %}

    {% set heroContent %}
        <div class="o-button-group">
            <a class="btn btn--medium
                      accent--white a--btn"
                href="{{ buildUrl('toplevel', 'under10k') }}">
                <span class="accent--pink a--text">
                    <span class="u-wide-only">{{ copy.callsToAction.under10k.long }}</span>
                    <span class="u-not-wide">{{ copy.callsToAction.under10k.short }}</span>
                </span>
            </a>

            <a class="btn btn--medium
                      accent--white a--btn"
                href="{{ buildUrl('toplevel', 'over10k') }}">
                <span class="accent--blue a--text">
                    <span class="u-wide-only">{{ copy.callsToAction.over10k.long }}</span>
                    <span class="u-not-wide">{{ copy.callsToAction.over10k.short }}</span>
                </span>
            </a>
        </div>
    {% endset %}

    {{
        hero.superHero(
            name = 'home-super',
            title = copy.intro.long,
            content = heroContent,
            caption = 'Cloughmills Community Action, Grant Â£4,975*'
        )
    }}

    <article role="main">
        <div class="inner">
            {# case studies #}
            <div class="accent--blue a--border-top carousel swiper-container"
                data-per-page="1">
                <div class="carousel__controls">
                    <button class="btn--carousel btn--carousel--round btn--carousel--prev js-carousel-prev">
                        {% include "../../includes/svg/arrow-left.svg" %}
                        <span class="u-visually-hidden">{{ __('global.accessibility.previousItem') }}</span>
                    </button>
                    <button class="btn--carousel btn--carousel--round btn--carousel--next js-carousel-next">
                        {% include "../../includes/svg/arrow-right.svg" %}
                        <span class="u-visually-hidden">{{ __('global.accessibility.nextItem') }}</span>
                    </button>
                </div>

                <ul class="swiper-wrapper unstyled">
                    {% for c in copy.caseStudies %}
                        <li class="swiper-slide">
                            {{
                                caseStudy(
                                    projectName = c.projectName,
                                    quoteName = c.quoteName,
                                    quoteText = c.quoteText,
                                    imageUrl = c.imagePath,
                                    imageSmallUrl = c.imageSmallPath,
                                    link = c.link
                                )
                            }}
                        </li>
                    {% endfor %}
                </ul>

            </div>

            {# funding finder #}
            <div class="central-gap">
                <a href="{{ buildUrl('funding/search-past-grants') }}"
                   class="btn btn--block accent--blue a--btn spaced">{{ copy.browseFundedProjects }}</a>
            </div>

            {# News Posts #}
            {% if news.length %}
                <div class="accent--blue a--border-top">
                    <div class="padded padded--wide-only">
                        <h3 class="t8 t3--a a--text accent--blue">{{ copy.latestNews }}</h3>
                        <ul class="unstyled grid grid--3-up grid--padded--large grid--equal grid--wide-only">
                            {% for n in news %}
                                <li class="grid__item">
                                    <h4 class="t3">
                                        <a class="u-unstyled-link" href="{{ n['link' | localeify(locale)] }}">
                                            {{ n['title' | localeify(locale)] | safe}}
                                        </a>
                                    </h4>
                                    <p>
                                        {{ n['text' | localeify(locale)] | safe }}
                                        <a href="{{ n['link' | localeify(locale)] }}"
                                            class="accent--pink a--text u-weight-heavy">{{ __('global.misc.readMore') }}&hellip;</a>
                                    </p>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% endif %}

        </div>

        <div class="inner--wide-only">
            {# tweets #}
            {% set twitterAccount = appData.config.get('social.twitterAccounts.' + locale)  %}
            <ul class="unstyled grid grid--wide-only grid--equal">
                <li class="grid__item grid__item--large accent--blue a--border-top padded">
                    <a class="twitter-timeline" href="https://twitter.com/{{ twitterAccount }}" data-tweet-limit="3" data-chrome="noheader">Tweets by {{ twitterAccount }}</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
                </li>
                <li class="grid__item accent--pink a--border-top">
                    <div class="form-ebulletin padded spaced">
                        <h3 class="t8 t3--a accent--pink a--text">{{ copy.ebulletin.title }}</h3>
                        <p class="intro">{{ copy.ebulletin.intro}}</p>
                        <a class="btn btn--small btn--block-full accent--pink a--btn"
                            href="https://www.biglotteryfund.org.uk/~/link.aspx?_id=0AEDBA52131B49BA82813576658AF148&_z=z">
                            {{ copy.ebulletin.callToAction }}
                        </a>
                    </div>

                    {# social buttons #}
                    <div class="gutter-mob-only">
                        <a href="{{ appData.config.get('social.instagram') }}" class="btn btn--small btn--outline accent--blue btn--block spaced">
                            <span class="btn__icon">{% include "../../includes/svg/instagram.svg" %}</span>
                            {{ copy.social.followUsOn }} {{ copy.social.instagram }}
                        </a>
                        <a href="{{ appData.config.get('social.facebookAccounts.' + locale) }}" class="btn btn--small btn--outline accent--blue btn--block spaced">
                            <span class="btn__icon">{% include "../../includes/svg/facebook.svg" %}</span>
                            {{ copy.social.followUsOn }} {{ copy.social.facebook }}
                        </a>
                        <a href="https://www.twitter.com/{{ appData.config.get('social.twitterAccounts.' + locale) }}" class="btn btn--small btn--outline accent--blue btn--block">
                            <span class="btn__icon">{% include "../../includes/svg/twitter.svg" %}</span>
                            {{ copy.social.followUsOn }} {{ copy.social.twitter }}
                        </a>
                    </div>

                </li>
            </ul>

        </div>
    </article>

{% endblock %}
