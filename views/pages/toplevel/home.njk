{% from "components/caseStudies.njk" import caseStudyFeature with context %}
{% from "components/ebulletin.njk" import ebulletinForm with context %}
{% from "components/hero.njk" import homepageSuperHero with context %}
{% from "components/icons.njk" import iconArrowLeft, iconArrowRight %}
{% from "components/news.njk" import articleTeaser with context %}
{% from "components/social.njk" import socialLinks with context %}

{% extends "layouts/main.njk" %}

{% block title %}{{ title }} | {% endblock %}

{% set socialImage = heroImage.default %}

{% block content %}
    {% set pageAccent = "blue" %}

    <main role="main">
        {{
            homepageSuperHero(
                copy = copy.hero,
                imageDefault = heroImage.default,
                imageCandidates = heroImage.candidates
            )
        }}

        <section class="inner">
            {# case studies #}
            <div class="carousel js-carousel
                swiper-container
                accent--{{ pageAccent }} a--border-top spaced--l"
                data-name="Case-studies carousel">
                <div class="carousel__controls">
                    <button class="btn--carousel btn--carousel--round btn--carousel--prev js-carousel-prev"
                        aria-label="When clicked this shows content from the previous slide">
                        {{ iconArrowLeft() }}
                        <span class="u-visually-hidden">{{ __('global.accessibility.previousItem') }}</span>
                    </button>
                    <button class="btn--carousel btn--carousel--round btn--carousel--next js-carousel-next"
                        aria-label="When clicked this shows content from the next slide">
                        {{ iconArrowRight() }}
                        <span class="u-visually-hidden">{{ __('global.accessibility.nextItem') }}</span>
                    </button>
                </div>

                <ul class="swiper-wrapper unstyled">
                    {% for c in copy.caseStudies %}
                        <li class="swiper-slide">
                            {{
                                caseStudyFeature(
                                    quoteText = c.quoteText,
                                    quoteName = c.quoteName,
                                    quoteNameCaption = c.quoteNameCaption,
                                    projectName = c.projectName,
                                    imageUrl = c.imageUrl,
                                    imageSmallUrl = c.imageSmallUrl,
                                    link = c.link
                                )
                            }}
                        </li>
                    {% endfor %}
                </ul>
            </div>

            <div class="central-gap">
                <a href="{{ buildUrl('funding/search-past-grants') }}"
                    class="btn btn--block accent--{{ pageAccent }} a--btn spaced">
                    {{ copy.browseFundedProjects }}
                </a>
            </div>
        </section>

        {# Latest News #}
        {% if news.length %}
        <section class="latest-news accent--{{ pageAccent }} a--border-top inner">
            <header class="latest-news__header">
                <h2 class="t1 t--underline a--text accent--blue">
                    <a class="u-link-minimal" href="{{ buildUrl("uk-wide/news-and-events") }}">
                        {{ __('global.misc.latestNews') }}
                    </a>
                </h2>
            </header>
            <div class="latest-news__content">
                <ul class="unstyled grid grid--3-up grid--padded--large grid--equal grid--wide-only">
                    {% for article in news %}
                        <li class="grid__item">
                            {{ articleTeaser(article) }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <footer class="latest-news__footer">
                <a class="latest-news__more" href="{{ buildUrl("uk-wide/news-and-events") }}">
                    {{ __('global.misc.viewAllNews') }}
                </a>
            </footer>
        </section>
        {% endif %}

        <section class="inner--wide-only spaced">
            <ul class="unstyled grid grid--wide-only grid--equal">
                <li class="grid__item grid__item--large accent--{{ pageAccent }} a--border-top padded">
                    {# Twitter Feed #}
                    {% set twitterAccount = appData.config.get('social.twitterAccounts.' + locale)  %}
                    <a class="twitter-timeline" data-dnt="true" data-chrome="noheader" data-tweet-limit="3"
                        href="https://twitter.com/{{ twitterAccount }}?ref_src=twsrc%5Etfw"
                    >
                        Tweets by {{ twitterAccount }}
                    </a>
                    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                </li>
                <li class="grid__item accent--pink a--border-top">
                    {# Ebulletin #}
                    <div class="content-box content-box--tinted">
                        {{ ebulletinForm() }}
                    </div>

                    {# social buttons #}
                    {{ socialLinks(copy.social) }}
                </li>
            </ul>
        </section>
    </main>
{% endblock %}
