{% from "../../components/hero.njk" import sectionHero %}
{% from "../../components/tabs.njk" import tabs %}

{% extends "../../layouts/main.njk" %}
{% set bodyClass = "has-full-bleed-header" %}

{% block title %}{{ title }} | {% endblock %}
{% set heroImage = createHeroImage({
    small: 'hero/working-families-small.jpg',
    medium: 'hero/working-families-medium.jpg',
    large: 'hero/working-families-large.jpg',
    default: 'hero/working-families-medium.jpg'
}) %}
{% set socialImage = heroImage %}

{% block content %}
    {{ sectionHero(
        titleText = title,
        image = heroImage,
        accent = 'pink'
    ) }}

    <main role="main">
        {% if entry.intro %}
            <section class="nudge-up content-box content-box--tinted content-box--flush-narrow-only
                inner--wide-only accent--pink a--border-top ">
                <div class="s-prose u-constrained-content-wide">
                    {{ entry.intro | safe }}
                </div>
            </section>
        {% endif %}

        {% macro tabContent(content) %}
            <div class="content-box content-box--borderless">
                <div class="s-prose s-prose--long u-constrained-content-wide">
                    {{ content | safe }}
                </div>
            </div>
        {% endmacro %}

        {% set tabItems = [] %}
        {% for section in entry.contentSections %}
            {% set newTab = {
                "id": "section-" + loop.index,
                "title": section.title,
                "content": tabContent(section.body),
                "active": loop.index === 1
            } %}
            {% set tabItems = (tabItems.push(newTab), tabItems) %}
        {% endfor %}

        <div class="inner--wide-only">
            {% if entry.contentSections.length > 1 %}
                {{
                    tabs(
                        id = entry.title | slugify,
                        content = tabItems
                    )
                }}
            {% else %}
                {% set section = entry.contentSections[0] %}
                <div class="content-box content-box--borderless">
                    <div class="s-prose s-prose--long u-constrained-content-wide">
                        <h2 class="t4 t--underline accent--pink">{{ section.title }}</h2>
                        {{ section.body | safe }}
                    </div>
                </div>
            {% endif %}
        </div>
    </main>
    </main>
{% endblock %}
