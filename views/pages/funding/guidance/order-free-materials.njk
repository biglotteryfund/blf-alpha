{% import "components/hero.njk" as hero %}
{% import "components/headers.njk" as headers %}
{% import "components/forms.njk" as forms %}

{% extends "layouts/main.njk" %}

{% block title %}{{ title }} | {% endblock %}

{% block content %}

    {% set heroContent %}
        <div class="nudge-bottom">
            {{ headers.blockheader('h2', title, 30, 'hero__header') }}
        </div>
    {% endset %}

    {{ hero.header('logo', heroContent, 'blue') }}

    <article role="main" class="nudge-up">

        <div class="inner--wide-only p accent--blue accent-b-t accent-bg bordered">
            intro
        </div>

        <div class="inner">

            <h3 class="t3a m-t m-l">Order Form</h3>

            <ul class="grid grid--wide-only grid--equal grid--3-up grid--padded">
                {% for item in materials %}
                    <li class="grid__item">
                        <div class="grid__item__inner accent--blue accent-b-t-l bordered p material-item">

                            <p class="m-t-none">
                                <strong>{{ item.name }}</strong>
                                {% if item.description %} <span class="smaller">({{ item.description }}){% endif %}</span>
                            </p>

                            {% set imgPath = 'images/materials/' + locale + '/' + item.image %}
                            <div class="material-item__media m-b"
                                 style="background-image: url({{ imgPath | getCachebustedPath }}">
                            </div>

                            <aside class="material-item__actions">
                                {% for p in item.products %}
                                    <form class="material-item__controls"
                                          method="post"
                                          action="/funding/funding-guidance/managing-your-funding/ordering-free-materials/item/{{ item.id }}">
                                        <input type="hidden" name="code" value="{{ p.code }}">
                                        <label class="m-t-none material-item__label">
                                            <strong>{% if p.name %}{{ p.name }} {{ item.name | lowercaseFirst }}{% else %}{{ item.name }}{% endif %}</strong>
                                            in {{ p.language }}
                                        </label>
                                        <button type="submit"
                                                value="decrease"
                                                name="action"
                                                class="btn btn--cta accent--turquoise m-t-none material-item__btn material-item__btn--decrease js-order-material-btn">
                                            -
                                        </button>
                                        <span class="material-item__quantity js-material-count">{{ orders[p.code].quantity or 0}}</span>
                                        <button type="submit"
                                                value="increase"
                                                name="action"
                                                class="btn btn--cta accent--turquoise m-t-none material-item__btn material-item__btn--increase js-order-material-btn">
                                            +
                                        </button>
                                    </form>
                                {% endfor %}
                            </aside>

                        </div>
                    </li>
                {% endfor %}
            </ul>

        </div>

        <div class="inner accent--blue accent-b-t p" id="your-details">
            <div class="p">
                <h3 class="t3a m-t-none">Your Details</h3>

                <form class="inline-form" method="post">
                    <ul class="grid grid--wide-only grid--3-up grid--padded">
                        {% for field in formFields %}
                            <li class="grid__item">{{ forms.input(field.name, field.label, inputType = field.type, required = field.required) }}</li>
                        {% endfor %}
                        <li class="grid__item"><input type="submit" class="accent--turquoise btn btn--cta btn--cta--large"></li>
                    </ul>
                </form>
            </div>
        </div>

    </article>

{% endblock %}