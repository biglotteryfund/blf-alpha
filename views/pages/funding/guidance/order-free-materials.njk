{% import "components/hero.njk" as hero %}
{% import "components/headers.njk" as headers %}
{% import "components/forms.njk" as forms %}

{% extends "layouts/main.njk" %}

{% block title %}{{ title }} | {% endblock %}

{% block content %}

    {% set heroContent %}
        <div class="nudge-bottom">
            {{ headers.blockheader('h2', title, 30, 'hero__header') }}
        </div>
    {% endset %}

    {{ hero.header('logo', heroContent, 'blue') }}

    <article role="main" class="nudge-up">
        <div class="inner--wide-only p">

            <ul class="grid grid--wide-only grid--equal grid--3-up grid--padded">
                {% for item in materials %}
                    <li class="grid__item">
                        <div class="grid__item__inner accent--blue accent-b-t-l bordered p material-item">
                            {% set imgPath = 'images/materials/' + locale + '/' + item.image %}
                            <div class="material-item__media m-b"
                                 style="background-image: url({{ imgPath | getCachebustedPath }}">
                            </div>
                            <h4>{{ item.name }}</h4>
                            {% if item.dimensions %}
                                <p>({{ item.dimensions[0] }}mm x {{ item.dimensions[1] }}mm)</p>
                            {% endif %}

                            <form class="material-item__controls"
                                  method="post"
                                  action="/funding/funding-guidance/managing-your-funding/ordering-free-materials/item/{{ item.id }}">
                                <input type="hidden" name="action" value="increase">
                                <select name="code" class="m-t-none">
                                    {% if item.multiProduct %}
                                            {% for languages in item.products %}
                                                <optgroup label="{{ languages.name }}">
                                                    {% for item in languages.ids %}
                                                        <option value="{{ item.code }}">{{ item.name }}</option>
                                                    {% endfor %}
                                                </optgroup>
                                            {% endfor %}
                                    {% else %}
                                            {% for p in item.products %}
                                                <option value="{{ p.code }}">{{ p.name }}</option>
                                            {% endfor %}
                                    {% endif %}
                                </select>
                                <button class="btn btn--cta m-t-none">Add</button>
                            </form>

                        </div>
                    </li>
                {% endfor %}
            </ul>

            {% if orders %}
                <h2>Order summary</h2>
                {% for code, order in orders %}
                    <form method="post"
                          action="/funding/funding-guidance/managing-your-funding/ordering-free-materials/item/{{ order.id }}">
                        <input type="hidden" name="code" value="{{ code }}">
                        <p>{{ code }}: x{{ order.quantity }} (item {{ order.id }})</p>
                        <button type="submit" name="action" value="decrease">Decrease</button>
                        <button type="submit" name="action" value="increase">Increase</button>
                        <button type="submit" name="action" value="remove">Remove</button>
                    </form>
                {% endfor %}
            {% endif %}

            <h2>Order form</h2>

            <form class="form-fund" method="post" action="/funding/order-materials">
                {{ forms.input('yourName', 'Your name') }}
                {{ forms.input('yourAddress', 'Your address', inputType = 'textarea') }}
                {{ forms.input('yourNumber', 'Your telephone number', inputType = 'tel') }}
                {{ forms.input('yourEmail', 'Your email address', inputType = 'email') }}
                {{ forms.input('yourProjectName', 'Your project name') }}
                {{ forms.input('yourProjectID', 'Your project ID number') }}
                {{ forms.input('yourGrantAmount', 'Your grant amount') }}
                <input type="submit">
            </form>



        </div>
    </article>

{% endblock %}