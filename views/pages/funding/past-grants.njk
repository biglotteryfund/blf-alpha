{% from "components/hero.njk" import hero %}
{% from "components/caseStudies.njk" import caseStudyCollection with context  %}
{% from "components/forms-new.njk" import formErrors, formField %}
{% from "components/icons.njk" import iconSearch %}

{% extends "layouts/main.njk" %}

{% set socialImage = heroImage %}

{% macro inlineFeedback() %}
    <details class="inline-feedback u-dont-print js-only" id="js-feedback">
        <summary>{{ copy.surveyText }}</summary>
        <feedback-form
            description="Past grants"
            label="Tell us what you think"
        />
    </details>
{% endmacro %}

{% macro grantNavForm() %}
    <form class="inline-search" role="search"
        action="http://grantnav.threesixtygiving.org/search" method="GET">
        <label class="inline-search__label ff-label" for="text_query">
            What are you searching for?
        </label>
        <div class="inline-search__group">
            <input class="inline-search__input ff-text"
                name="text_query" id="text_query" type="search" value="">
            <input name="json_query" type="hidden" value="{{ grantNavFacets | dump }}">
            <button class="inline-search__submit" type="submit">
                {{ iconSearch() }}
                {{ __('global.misc.search') }}
            </button>
        </div>
    </form>
{% endmacro %}

{% block content %}
    {% set pageAccent = 'pink' %}

    <main role="main">
        {{
            hero(
                titleText = copy.title,
                image = heroImage,
                accent = pageAccent
            )
        }}

        <div class="nudge-up">
            <div class="content-box inner--wide-only accent--{{ pageAccent }} a--border-top">
                <section class="u-separator s-prose s-prose--long u-constrained-content-wide">
                    <p>{{ copy.intro | safe }}</p>
                    {{ inlineFeedback() }}
                </section>

                <p>In the the meantime, there are two ways you can explore our past grants.</p>

                <ul class="grid grid--2-up grid--padded grid--equal grid--wide-only">
                    <li class="grid__item">
                        <section class="content-box accent--{{ pageAccent }} a--border-top u-flex-stretch">
                            <h2 class="u-margin-bottom-flush">1. Use the GrantNav site</h2>
                            <p class="t-caption">Not run by the Big Lottery Fund, but quick, nicely designed and full of our data</p>
                            {{ grantNavForm() }}
                        </section>
                    </li>
                    <li class="grid__item">
                        <section class="content-box accent--{{ pageAccent }} a--border-top u-flex-stretch">
                            <h2 class="u-margin-bottom-flush">2. Use our current grants database</h2>
                            <p class="t-caption">Official, but bit less nice to use</p>
                            <p><a class="btn btn--medium btn--outline" href="/funding/search-past-grants">Browse past grants</a></p>
                        </section>
                    </li>
                </ul>
            </div>
        </div>
    </main>
{% endblock %}
