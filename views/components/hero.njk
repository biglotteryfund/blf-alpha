{% import "components/headers.njk" as headers %}

{% macro hero(titleText, image, accent = 'blue') %}
    <section class="hero">
        <div class="hero__image">
            <picture>
                <source srcset="{{ image.large }}" media="(min-width: 980px)">
                <source srcset="{{ image.medium }}" media="(min-width: 600px)">
                <source srcset="{{ image.small }}">
                <img src="{{ image.default }}" alt="{{ image.caption }}" />
            </picture>
        </div>
        <div class="hero__content">
            <div class="hero__header inner" id="content">
                <div class="hero__header__inner">
                    {{ headers.overlayText(
                        tag = 'h1',
                        text = titleText,
                        additionalClasses = 'hero__title overlay-text--deep t4 accent--' + accent)
                    }}
                </div>
            </div>
            {% if image.caption %}
                <span class="hero__caption u-desktop-only">
                    <span class="u-caption">{{ image.caption }}</span>
                </span>
            {% endif %}
        </div>
    </section>
{% endmacro %}

{% macro superHero(title, content, imageDefault, imageCandidates) %}
    <section class="super-hero{% if imageCandidates.length > 0 %} super-hero--has-candidates{% endif %} js-random-hero" data-image-candidates='{{ imageCandidates | dump | safe }}'>
        <div class="super-hero__image js-random-hero__image">
            <picture>
                <source srcset="{{ imageDefault.large }}" media="(min-width: 980px)">
                <source srcset="{{ imageDefault.medium }}" media="(min-width: 600px)">
                <source srcset="{{ imageDefault.small }}">
                <img src="{{ imageDefault.default }}" alt="{{ imageDefault.caption }}" />
            </picture>
        </div>

        <div class="super-hero__content">
            <div class="super-hero__header inner" id="content">
                <h1 class="super-hero__title">{{ title | safe }}</h1>
                {{ content | safe }}
            </div>
            {% if imageDefault.caption %}
                <div class="super-hero__caption u-desktop-only">
                    <span class="u-caption js-random-hero__caption">
                        {{ imageDefault.caption }}
                    </span>
                </div>
            {% endif %}
        </div>
    </section>
{% endmacro %}


{% macro homepageSuperHero(copy, imageDefault, imageCandidates) %}
    {% set heroContent %}
        <div class="o-button-group">
            <a class="btn btn--reversed btn--medium"
                href="{{ localify('/funding/under10k') }}"
                id="qa-button-under10k">
                <span class="accent--pink a--text">
                    <span class="u-wide-only">{{ copy.under10k.long }}</span>
                    <span class="u-not-wide">{{ copy.under10k.short }}</span>
                </span>
            </a>
            <a class="btn btn--reversed btn--medium"
                href="{{ localify('/funding/over10k') }}"
                id="qa-button-over10k">
                <span class="accent--blue a--text">
                    <span class="u-wide-only">{{ copy.over10k.long }}</span>
                    <span class="u-not-wide">{{ copy.over10k.short }}</span>
                </span>
            </a>
        </div>
    {% endset %}

    {{
        superHero(
            title = copy.intro,
            content = heroContent,
            imageDefault = imageDefault,
            imageCandidates = imageCandidates
        )
    }}
{% endmacro %}


{% macro miniatureHero(titleText, imagePath, imagePathMobile = false, imageCaption = false, linkUrl = false, accent) %}
    {% set imagePath = imagePath | getImagePath %}
    {% if not imagePathMobile %}
        {% set imagePathMobile = imagePath %}
    {% endif %}
    <div class="miniature-hero accent--{{ accent }} a--border-top--large">
        <div class="miniature-hero__inner">
            {% if linkUrl %}<a class="miniature-hero__link u-dont-print-link" href="{{ linkUrl }}">{% endif %}

            <div class="minature-hero__image">
                {% if imagePathMobile %}
                    <picture>
                        <source srcset="{{ imagePath }}" media="(min-width: 760px)">
                        <img src="{{ imagePathMobile }}"{% if imageCaption %} alt="{{ imageCaption }}{% endif %}" />
                    </picture>
                {% else %}
                    <img src="{{ imagePath }}"{% if imageCaption %} alt="{{ imageCaption }}{% endif %}" />
                {% endif %}
            </div>

            {% if linkUrl %}</a>{% endif %}

            <div class="minature-hero__content">
                {{ headers.overlayText(
                    tag = 'h3',
                    text = titleText,
                    additionalClasses = 't4 overlay-text--wide is-opaque',
                    link = linkUrl,
                    showArrow = true
                )}}
            </div>
        </div>
    </div>
{% endmacro %}
