{% import "./forms.njk" as forms %}

{% macro showSurvey() %}
    <form id="js-survey-container"
          class="survey"
          method="post"
          :action="'/survey/' + survey.id">
        <h6 class="survey__header">
            <% localeify(survey, 'question', '{{ locale }}') %><span class="survey__arrow js-survey-arrow">{% include "../includes/svg/arrow-down.svg" %}</span>
        </h6>
        <aside class="survey__response">
            <p>Thank you for sharing your feedback with us &ndash; we appreciate your time.</p>
            <p>We're sorry, there was an error recording your response. Please try again.</p>
        </aside>

        <fieldset>

            <button v-for="choice in survey.choices"
                    type="button"
                    class="btn btn--small survey__btn"
                    name="choice">
                <% localeify(choice, 'title', '{{ locale }}') %>
            </button>

            <div v-for="choice in survey.choices"
                 v-if="choice.allow_message">
                <div class="grid grid--padded survey__extra">
                    {# prompt for more info #}
                    <div class="grid__item">
                        {{ forms.input(
                            fieldName = 'message',
                            fieldLabel = 'How could we have made this page better?',
                            inputType = 'textarea',
                            required = false,
                            customPlaceholder = 'Tell us how we could improve this page...'
                        ) }}
                    </div>
                    {# submit the survey as a "no" #}
                    <div class="grid__item survey__submit">
                        <button type="submit"
                                name="choice"
                                :value="choice.id"
                                class="btn btn--small survey__btn">
                            Submit
                        </button>
                    </div>
                </div>
            </div>

        </fieldset>
    </form>
{% endmacro %}
