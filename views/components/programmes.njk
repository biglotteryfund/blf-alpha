{% macro fundingRange(minimum, maximum) %}
    £{{ minimum | numberWithCommas}}{% if maximum %} to £{{ maximum | numberWithCommas }}{% endif %}
{% endmacro %}

{% macro programmeStats(fields, isCompact) %}
    <dl class="o-definition-list{% if isCompact %} o-definition-list--compact{% endif %}">
        {% if fields.area %}
            <dt>{{ __('global.programmes.programmeLabels.area') }}</dt>
            <dd>{{ fields.area.label }}</dd>
        {% endif %}
        {% if fields.organisationTypes %}
            <dt>{{ __('global.programmes.programmeLabels.organisationTypes') }}</dt>
            <dd>{{ fields.organisationTypes | join(', ') }}</dd>
        {% endif %}
        {% if fields.fundingSize %}
            <dt>{{ __('global.programmes.programmeLabels.fundingSize') }}</dt>
            {% if fields.fundingSizeDescription %}
                <dd>{{ fields.fundingSizeDescription }}</dd>
            {% else %}
                <dd>{{ fundingRange(
                    minimum = fields.fundingSize.minimum,
                    maximum = fields.fundingSize.maximum
                ) }}</dd>
            {% endif %}
        {% endif %}
        {% if fields.totalAvailable %}
            <dt>{{ __('global.programmes.programmeLabels.totalAvailable') }}</dt>
            <dd>{{ fields.totalAvailable }}</dd>
        {% endif %}
        {% if fields.applicationDeadline %}
            <dt>{{ __('global.programmes.programmeLabels.applicationDeadline') }}</dt>
            <dd>{{ fields.applicationDeadline }}</dd>
        {% endif %}
    </dl>
{% endmacro %}

{% macro programmeCard(programme, accent, isMinimal) %}
    <article
        class="programme-card{% if isMinimal %} programme-card--minimal{% else %} accent--{{ accent }} a--border-top a--border-color{% endif %} qa-programme-card">
        <header class="programme-card__header">
            <h3 class="programme-card__title t1">
                <a class="u-link-minimal{% if not isMinimal %} accent--{{ accent }} a--text{% endif %}" href="{{ programme.linkUrl }}">
                    {{ programme.title }}
                </a>
            </h3>
            {% if programme.photo %}
                <div class="programme-card__media">
                    <img src="{{ programme.photo }}" alt=""/>
                </div>
            {% endif %}
        </header>
        <div class="programme-card__body">
            {% if programme.description %}
                <div class="programme-card__description">
                    <p>{{ programme.description }}</p>
                </div>
            {% endif %}
            <div class="programme-card__details">
                {{ programmeStats(fields = programme) }}
            </div>
        </div>
    </article>
{% endmacro %}

{% macro programmeList(programmes, accent, labels) %}
    <div class="programmes-list">
        {% for programme in programmes %}
            <div class="programmes-list__item">
                {{ programmeCard(
                    programme = programme.content,
                    accent = accent
                ) }}
            </div>
        {% endfor %}
    </div>
{% endmacro %}

{% macro selectionTrail(trail, itemCount) %}
    {% if trail | length > 0 %}
    <ol class="selection-trail">
        {% for crumb in trail %}
        <li class="selection-trail__item">
            {% set showUrl = crumb.url %}
            {% if showUrl %}<a class="selection-trail__link" href="{{ crumb.url }}">{% endif %}{{ crumb.label }}{% if loop.last and itemCount %} ({{ itemCount }}){% endif %}{% if showUrl %}</a>{% endif %}
        </li>
        {% endfor %}
    </ol>
    {% endif %}
{% endmacro %}
