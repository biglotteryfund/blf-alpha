{% macro textInput(fieldName, fieldLabel, inputType = 'text', required = false, extraClasses = false, helpText = false, charLimit = false, showErrorsBelowFields = false) %}

    {% set error = getFormErrorForField(getFlash(request, 'formErrors'), fieldName) %}
    {# this is whitespace sensitive so don't add newlines! #}
    {% set placeholderText %}{{ fieldLabel }}{% if required %} *{% endif %}{% endset %}
    {% if not showErrorsBelowFields %}
        {# show errors in placeholders instead #}
        {% set placeholderText %}{% if customPlaceholder %}{{ customPlaceholder }}{% elseif error %}{{ error.msg }}{% else %}{{ fieldLabel }}{% endif %}{% if required %} *{% endif %}{% endset %}
    {% endif %}

    <label class="form-fund__item" for="ff-{{ fieldName }}">{{ fieldLabel }}{% if required %} *{% endif %}</label>

    {% if inputType == 'textarea' %}
        <textarea class="form-fund__item{% if error %} is-error{% endif %}{% if extraClasses %} {{ extraClasses }}{% endif %}{% if charLimit %} js-has-char-limit{% endif %}"{% if error %} aria-invalid{% endif %}
                  name="{{ fieldName }}"
                  placeholder="{{ placeholderText }}"
                  id="ff-{{ fieldName }}"{% if required %} required aria-required="true"{% endif %}{% if charLimit %} data-char-limit="{{ charLimit }}"{% endif %}>{{ getFlash(request, 'formValues', fieldName) }}</textarea>
    {% else %}
        <input class="form-fund__item{% if error %} is-error{% endif %}{% if extraClasses %} {{ extraClasses }}{% endif %}{% if charLimit %} js-has-char-limit{% endif %}"{% if error %} aria-invalid{% endif %}
               type="{{ inputType }}"
               name="{{ fieldName }}"
               id="ff-{{ fieldName }}"{% if sssrequired %} required aria-required="true"{% endif %}
               value="{{ getFlash(request, 'formValues', fieldName) }}"
               placeholder="{{ placeholderText }}"{% if charLimit %} data-char-limit="{{ charLimit }}"{% endif %}>
    {% endif %}
    {% if showErrorsBelowFields %}
        <p class="spaced--t error t6">
            {% if error %}{{ error.msg }}{% else %}&nbsp;{% endif %}
        </p>
    {% endif %}
    {% if helpText %}
        <span class="help-block">{{ helpText }}</span>
    {% endif %}
{% endmacro %}

{% macro checkboxes(fieldName, options) %}
    {% set error = getFormErrorForField(getFlash(request, 'formErrors'), fieldName) %}
    {% if error %}<p class="error t6">{{ error.msg }}</p>{% endif %}

    {% for o in options %}
        <label class="{% if error %} is-error{% endif %}"{% if error %} aria-invalid{% endif %}
               for="ff-checkbox-{{ o[2] }}-{{ o[1] }}">
            {{ o[0] }}
            <input type="checkbox"
                   id="ff-checkbox-{{ o[2] }}-{{ o[1] }}"
                   name="{{ o[2] }}"
                   value="yes" />
        </label>
    {% endfor %}

{% endmacro %}

{% macro radioButton(fieldName, label, value, required = false, suppressErrors = false, otherId = false, translateOptionLabels = false) %}
    {% set uniqueId = 'ff-radio-' + fieldName + '-' + value %}
    {% set error = getFormErrorForField(getFlash(request, 'formErrors'), fieldName) %}
    {% if not suppressErrors and error %}
        <p class="error">{{ error.msg }}</p>
    {% endif %}
    <label class="label-radio__item{% if error %} is-error{% endif %}"{% if error %} aria-invalid{% endif %}
           for="{{ uniqueId }}">
        <input type="radio"
               id="{{ uniqueId }}"
               name="{{ fieldName }}"{% if required %} required aria-required="true"{% endif %}
               value="{{ value }}"{% if otherId %} class="js-radio-has-other" data-other-id="{{ otherId }}"{% endif %} />
        {% if translateOptionLabels %}{{ __(label) }}{% else %}{{ label }}{% endif %}
    </label>
{% endmacro %}

{% macro radios(fieldName, label = false, options, allowOther = false, translateOptionLabels = false) %}
    {% set error = getFormErrorForField(getFlash(request, 'formErrors'), fieldName) %}
    {% if label %}<label class="label-radio">{{ label }}</label>{% endif %}
    {% for opt in options %}
        {{ radioButton(fieldName, opt.name, opt.value, false, true, translateOptionLabels = translateOptionLabels) }}
    {% endfor %}
    {% if allowOther %}
        {% set otherId = 'js-other-' + fieldName %}
        {{ radioButton(fieldName, __('global.forms.otherEnterBelow'), 'other', false, true, otherId = otherId) }}
        <input type="text" name="{{ fieldName }}Other" id="{{ otherId }}" style="display: none;" placeholder="{{ label }}" />
    {% endif %}
    {% if error %}<p class="error t6 spaced--t">{{ error.msg }}{% endif %}
{% endmacro %}
