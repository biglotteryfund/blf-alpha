{% from "components/hero.njk" import hero with context %}
{% from "components/ebulletin.njk" import ebulletinForm with context %}
{% from "components/form-fields/macros.njk" import formErrors, formField with context %}

{% extends "layouts/main.njk" %}

{% block content %}
    {{ hero(title, pageHero.image) }}

    <main role="main" class="nudge-up">
        <div class="content-box u-inner-wide-only accent--{{ pageAccent }} a--border-top">
            {% if status === 'SUCCESS' %}
                <div class="s-prose">
                    <h3>{{ copy.responses.success.title }}</h3>
                    <p>{{ copy.responses.success.body | safe }}</p>
                </div>
            {% elseif status === 'ERROR' %}
                <h3>{{ copy.responses.error.title }}</h3>
                <p>{{ copy.responses.error.body | safe }}</p>
            {% else %}
                <form class="form-ebulletin form-theme-slim" method="post" action="/about/ebulletin">
                    {% set formCopy = __('toplevel.ebulletin') %}
                    <h2 class="t1 t--underline accent--pink a--text">{{ formCopy.introHeading }}</h2>

                    <p>{{ formCopy.intro }}</p>

                    {{ formErrors(
                        errors = errors,
                        title = formCopy.responses.error.title
                    ) }}

                    {{ formField({
                        name: 'location',
                        type: 'radio',
                        label: formCopy.location,
                        value: data.location,
                        options: [{
                            label: formCopy.locations.england,
                            value: 'ENGLAND_MAIL'
                        }, {
                            label: formCopy.locations.wales,
                            value: 'WALES_MAIL'
                        }, {
                            label: formCopy.locations.scotland,
                            value: 'SCOTLAND_MAIL'
                        }, {
                            label: formCopy.locations.northernIreland,
                            value: 'NI_MAIL'
                        }]
                    }, errors = errors) }}

                    <fieldset class="form-fieldset form-fieldset--details">
                        <legend class="form-fieldset__legend u-visually-hidden">
                            {{ formCopy.yourDetails }}
                        </legend>
                        <div class="form-fieldset__fields">
                            {{ formField({
                                type: 'text',
                                name: 'firstName',
                                autocompleteName: 'given-name',
                                label: formCopy.fields.firstName,
                                value: data.firstName,
                                isRequired: true
                            }, errors = errors) }}

                            {{ formField({
                                type: 'text',
                                name: 'lastName',
                                autocompleteName: 'family-name',
                                label: formCopy.fields.lastName,
                                value: data.lastName,
                                isRequired: true
                            }, errors = errors) }}

                            {{ formField({
                                type: 'text',
                                name: 'organisation',
                                autocompleteName: 'organization',
                                label: formCopy.fields.organisation,
                                value: data.organisation,
                                isRequired: false
                            }, errors = errors) }}

                            {{ formField({
                                type: 'email',
                                name: 'email',
                                autocompleteName: 'email',
                                label: formCopy.fields.emailAddress,
                                value: data.email,
                                placeholder: 'yourname@example.com',
                                isRequired: true
                            }, errors = errors) }}
                        </div>
                    </fieldset>

                    <input type="submit" value="{{ formCopy.callToAction }}"
                        class="btn btn--small accent--pink a--btn u-block-full"/>
                </form>
            {% endif %}
        </div>
    </main>
{% endblock %}
