{% extends "layouts/main.njk" %}
{% from "components/data.njk" import statsGrid %}
{% from "components/hero-image/macro.njk" import heroImage with context %}
{% from "components/page-title/macro.njk" import pageTitle %}

{% macro mapPane(id, title, stats, isActive = false) %}
    <section id="region-{{ id }}" class="js-tab-pane tab__pane{% if isActive %} is-active{% endif %}">
        <article class="map-info accent--pink a--border-top u-padded">
            <h3 class="t2 t--underline">{{ title }}</h3>
            {% for stat in stats %}
                <p class="map-info__stat">
                    <span class="map-info__stat-data t2 accent--pink a--text">{{ stat.value }}</span>
                    <span class="map-info__stat-caption"><strong>{{ stat.label }}</strong></span>
                </p>
            {% endfor %}
        </article>
    </section>
{% endmacro %}

{% block content %}
    {% set pageAccent = 'blue' %}

    {{ heroImage(pageHero.image) }}
    <main class="u-nudge-up">
        {{ pageTitle(title) }}

        <div class="content-box content-box--borderless u-inner-wide-only accent--{{ pageAccent }} a--border-top">
            <h2 class="t2 t--underline">{{ copy.keyStats }}</h2>
            {{ statsGrid(dataStats.stats) }}
        </div>

        <aside class="map-holder u-accent-border-top-{{ pageAccent }}">
            <div class="map-holder__inner u-inner-wide-only u-padded">
                <h2 class="t2 t--underline accent--{{ pageAccent }}">{{ copy.mapTitle }}</h2>

                <div class="map-wrapper" role="tablist">
                    {% include "includes/uk-countries.njk" %}
                </div>


                <div id="js-map-panes" class="map-panes js-paneset">
                    {% set regionTitles = __('global.regions') %}
                    {{ mapPane(
                        id = 'england',
                        title = regionTitles.england,
                        stats = dataStats.regions.england,
                        isActive = true
                    ) }}
                    {{ mapPane(
                        id = 'northern-ireland',
                        title = regionTitles.northernIreland,
                        stats = dataStats.regions.northernIreland
                    ) }}
                    {{ mapPane(
                        id = 'scotland',
                        title = regionTitles.scotland,
                        stats = dataStats.regions.scotland
                    ) }}
                    {{ mapPane(
                        id = 'wales',
                        title = regionTitles.wales,
                        stats = dataStats.regions.wales
                    ) }}
                </div>

            </div>
        </aside>
    </main>
{% endblock %}
