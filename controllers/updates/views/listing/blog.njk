{% from "components/breadcrumb-trail/macro.njk" import breadcrumbTrail %}
{% from "components/article-teaser/macro.njk" import articleTeaser %}
{% from "components/hero.njk" import hero with context %}
{% from "components/split-nav/macro.njk" import splitNav %}

{% extends "layouts/main.njk" %}

{% block content %}
    {% set pageAccent = 'pink' %}

    <main role="main" id="content">

        {{ hero(
            titleText = title,
            image = heroImage,
            accent = pageAccent
        ) }}

        <div class="nudge-up">
            <div class="content-box u-inner-wide-only accent--{{ pageAccent }} a--border-top">
                {{ breadcrumbTrail(breadcrumbs) }}
                <div class="s-prose">
                    <p>Blog intro text goes here @TODO</p>
                </div>
            </div>
        </div>

        <section class="content-box u-inner-wide-only accent--{{ pageAccent }} a--border-top">
            <div class="u-constrained-wide">

                {# @TODO handle this design #}
                {% if entriesMeta.pageType === 'author' %}
                    {% set activeAuthor = entriesMeta.activeAuthor %}
                    <h1>Viewing all posts by {{ activeAuthor.title }}</h1>
                {% elseif entriesMeta.pageType === 'tag' %}
                    {% set activeTag = entriesMeta.activeTag %}
                    <h1>Viewing all posts tagged {{ activeTag.title }}</h1>
                {% elseif entriesMeta.pageType === 'category' %}
                    {% set activeCategory = entriesMeta.activeCategory %}
                    <h1>Viewing all posts in {{ activeCategory.title }}</h1>
                {% else %}
                    <h1>{{ title }}</h1>
                {% endif %}

                <ol class="article-listing">
                    {% for entry in entries %}
                        <li class="article-listing__item">
                            {% set subtitle %}
                                <time class="article-teaser__pubdate" datetime="{{ props.postDate.date }}">
                                    {{ formatDate(entry.postDate.date, DATE_FORMATS.short) }}
                                </time>
                                {% if entry.category -%}
                                    {# Only blog posts have categories #}
                                    in <a href="{{ localify('/news/blog/?category=' + entry.category.slug) }}">{{ entry.category.title }}</a>
                                {%- endif %}
                            {% endset %}
                            {{ articleTeaser({
                                'title': entry.trailText or entry.title,
                                'subtitle': subtitle | safe,
                                'summary': entry.summary,
                                'linkUrl': entry.linkUrl
                            }) }}
                        </li>
                    {% endfor %}
                </ol>

                {{ splitNav(
                    prevLink = {
                        "label": "Previous page",
                        "url": pagination.prevLink
                    },
                    nextLink = {
                        "label": "Next page",
                        "url": pagination.nextLink
                    }
                ) }}
            </div>

        </section>
    </main>
{% endblock %}
